<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabela de Pontuação</title>

    <link rel="stylesheet" href="./menuHamburger/navegacao.css">
    <link rel="stylesheet" href="./main.css">
    <link rel="stylesheet" href="./logar.css">
    
</head>
<body>
    <!-- menu hamburger -->
    <nav class="wraperNavegacao" id="wraperNavegacao">
        <p class="linkMenu menuHamburger" id="idMenuHamburger">&#9776;</p>
        <ul class="ulMenu" id="ulMenu">
            <script> 
                const baseUrl = "https://placar-gamificado-teste.onrender.com";
                const links = document.querySelectorAll('.linkMenu');
                links.forEach(link => {link.href = `${baseUrl}${link.getAttribute('href')}`;});
            </script>
            <a class="linkMenu" href="/public/index.html"><li class="listMenu">Home</li></a>
            <a class="linkMenu" href="/pr/scoreBoard.html"><li class="listMenu">Placar</li></a>
            <a class="linkMenu" href="/pr/regulamento.html"><li class="listMenu">Regulamento</li></a>
        </ul>
    </nav>
    
    <main id="main">

        <h1>Logar</h1>
        <ul id="ulLogar">
            <button onclick="redirecionarLogin()">Logar</button>
                
            <button id="btnCadastrar">Cadastrar</button>
                <form id="formCadastro" style="display: none;">
                    <input type="text" id="username" placeholder="Usuário" required>
                    <input type="password" id="password" placeholder="Senha" required>
                    <button type="submit">Enviar</button>
                </form>
            <button onclick="redirecionarLogout()">Sair</button>
            
        </ul>
    </main>

    <script type="module" src="./menuHamburger/navegacao.js"></script>
    <!-- // cadastrar usuário novo -->
    <script>
        
        function redirecionarLogin() {
            window.location.href = 'http://localhost:3000/public/logar.html';
            // consertar
        }
                
        function redirecionarLogout() {
            window.location.href = 'http://localhost:3000/logout';
        }

        // Toggle do formulário de cadastro
        const btnCadastrar = document.getElementById('btnCadastrar');
        btnCadastrar.addEventListener('click', function() {
            const form = document.getElementById('formCadastro');
            form.style.display = form.style.display === 'none' ? 'block' : 'none';
            btnCadastrar.style.display = form.style.display === 'none' ? 'block' : 'none';
        });

        document.getElementById('formCadastro').addEventListener('submit', async function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            const response = await fetch('http://localhost:3000/registro', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ username, password })
            });

            const data = await response.json();
            if (response.ok) {
                alert('Usuário cadastrado com sucesso!');
            } else {
                alert('Erro: ' + (data.error || 'Não foi possível cadastrar'));
            }
        });
    </script>
</body>
</html>
